########################################
# OVH / Apache config - SPA + assets
########################################

# Évite que Apache fasse de la négociation de contenu foireuse
Options -Multiviews

# Types MIME explicites
<IfModule mod_mime.c>
  AddType application/javascript .js
  AddType text/css .css
  AddType image/svg+xml .svg
  AddType application/json .json
</IfModule>

# Réécriture
<IfModule mod_rewrite.c>
  RewriteEngine On

  # 1) Toujours servir les fichiers statiques tels quels
  #    (et court-circuiter toute réécriture SPA)
  RewriteCond %{REQUEST_URI} ^/assets/ [OR]
  RewriteCond %{REQUEST_URI} ^/browser- [OR]
  RewriteCond %{REQUEST_URI} \.(js|css|png|jpg|jpeg|gif|svg|webp|ico|woff|woff2|ttf|map)$ [NC]
  RewriteCond %{REQUEST_FILENAME} -f
  RewriteRule ^ - [L]

  # 2) Fallback SPA uniquement si ce n'est PAS un fichier/dossier réel
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^ index.html [L]
</IfModule>

########################################
# Fin .htaccess
########################################
